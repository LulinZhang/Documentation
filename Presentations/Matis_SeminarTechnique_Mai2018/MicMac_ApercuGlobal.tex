\documentclass{beamer}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\title{MicMac -- a global overview}
%\subtitle{Beamer demonstration: longer subtitle}
\institute{IGN}
\date[25 May 2018]{Technical seminar}
\author[E Rupnik]{E Rupnik, J-M Muller, M Pierrot Deseilligny} 

\newcommand{\todo}[1]{\textcolor{red}{#1}}

\usetheme{ign}

\begin{document}


    \begin{frame}[plain]
        \titlepage{}
    \end{frame}

	\tableofcontents
	
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Bilans de la prese
%1/ er: introduction/overview of the processing pipeline    ~3 slides ~3mins
%2/ jmm: tie points extraction
%		+no a priori, extraction algos                      ~2-3      ~3mins
%       +with a priori,                                     ~2-3      ~3mins
%		+reduction algos                                    ~2        ~2mins

%3/ er: image orientation
%       sfm				                                    ~2-3      ~3mins
%       BBA                                                 ~2-3      ~3mins
%       structureless BBA                                   ~2-3      ~3mins
%4/ er: georef                                              ~1-2      ~1mins
	
	
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Introduction        
      \section{Introduction}  
        \subsection*{The processing pipeline}
            \begin{frame}{Overview of the processing pipeline}
                %\framesubtitle{The proof uses \textit{reductio ad absurdum}.}
                \includegraphics[width=10cm]{images/architecture_prntscr.png}
                
%change the graphic:
% remove A (and fix Patis->Pastis)
% make depth map on the right of Malt&co
% add more descriptive names (or maybe in items below Tapas=corresp)                
% introduce tool by tool on diff slides
                
            \end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Tie-points
\section{Tie points extraction}
\subsection{Without a priori geometry}
        \begin{frame}{Tie points extraction }
                \framesubtitle{Without \textit{a priori} geometry}

                \begin{block}{Tie points detection}
                        \begin{itemize}
                        \item SIFT : default
                        \item Digeo : slightly faster, possibility to use only max or min
                        \item AIME (presented by MPD during spotlight), under developpment; generally faster than SIFT
                        \end{itemize}
                \end{block}
                
                \begin{block}{Tie points Matching}
                \begin{itemize}
                        \item ANN (Approximate Nearest Neighbor)
                        \item for a point in pic A, find best and second best points in pic B.
                        The best point is accepted if his score is high and second best score is low.
                        \end{itemize}
                \end{block}
                
        \end{frame}
        
        \begin{frame}{Tie points extraction }
                \framesubtitle{Without \textit{a priori} the geometry}   
                \begin{block}{Extraction organization : lists of pictures pairs}
                \begin{itemize}
                        \item All, MulScale, Line...
                        \item from an orientation (GPS, approximate orientation)
                \end{itemize}
                \end{block}
                \textbf{Tapioca} command. See ยง3.3 and ยง16 of documentation.
                
                \begin{block}{Tie points files format (binary and ASCII)}
                \begin{itemize}
                        \item Default : 1 file per pair, simple and universal
                        \item New format : 1 file with points multiplicity, faster but only usable with few commands
                \end{itemize}
                \end{block}
                \textbf{mm3d TestLib ConvNewFH} command. See ยง16.8 of documentation.
        \end{frame}

\subsection{With a priori geometry}        
        \begin{frame}{Tie points extraction}
                \framesubtitle{With \textit{a priori} geometry}
                \begin{itemize}
                        \item ``Second iteration'': using camera orientations and a 3d mesh
                        \item finds tie points with good repartition on pictures and 3d mesh
                        \item use orientations for perspective corrections before correlation
                \end{itemize}
                \textbf{mm3d TiePTri} command. See ยง16.9 of documentation.
                
                \centering{\includegraphics[width=7cm]{images/imgselect_brief}}
        \end{frame}

\subsection{Reduction algorithms}
        \begin{frame}{Tie points reduction algorithms}
                Four tools are dedicated to Tie points reduction: 
                \begin{itemize}
                        \item \textbf{RedTieP} / \textbf{Schnaps} (generic case): only one point per picutre part, favor manifold
                        \item \textbf{OriRedTieP} / \textbf{Ratafia} (quasi-vertical case) : favor scene repartition
                \end{itemize}
                
                \centering{
                        \includegraphics[width=5cm]{images/Schnaps_homol_all} \ 
                        \includegraphics[width=5cm]{images/Schnaps_homol_100}
                }
                
        \end{frame} 
                        
                 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Pose estimation
\section{Image orientation}       
		\begin{frame}{Image orientation}
			\framesubtitle{Approaches}
			\begin{enumerate}
			\item no a priori, iterative (i.e. SfM)
			\item with a priori, collinearity-based bundle block adjustment (BBA) when initial orientations are known 
			\item structureless BBA
			
			\end{enumerate}
		\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% SfM
	\subsection{SfM and structureless BBA}	 

%%%%%%%%%%%%%%%%%%%%%%%%%%% 			 sfm0		
%		\begin{frame}{SfM}
%			\begin{columns}
%			\column{0.5\textwidth}
%			\setlength{\unitlength}{1cm}
%			\hspace{1cm}
%%
%		Pipeline:
%		\begin{itemize} 
%			\item \footnotesize \textcolor{red}{\textbf{iterative}} creation of global poses
%			\item \footnotesize all poses in the coordinate system attached to a selected camera 
%		\end{itemize}
%%  
%
%		\column{0.65\textwidth}
%		\setlength{\unitlength}{1cm}
%		\includegraphics[width=7.5cm]{images/sfm0.pdf} 
%
%		\end{columns}
%		\end{frame}	
	
%%%%%%%%%%%%%%%%%%%%%%%%%% 			 sfm1		
		\begin{frame}{SfM}
			\begin{columns}
			\column{0.5\textwidth}
			\setlength{\unitlength}{1cm}
			\hspace{1cm}
%
		Pipeline:
		\begin{itemize} 
			\item \footnotesize \textcolor{red}{\textbf{iterative}} creation of global poses
			\item \footnotesize all poses in the coordinate system attached to a selected camera
			\item \footnotesize direct algorithms \\(e.g. essential matrix, resection) 
			\item \footnotesize bundle block adjustment \\ every $n$ images
		\end{itemize}
%  

		\column{0.65\textwidth}
		\setlength{\unitlength}{1cm}
		\includegraphics[width=7.5cm]{images/sfm1.pdf} 

		\end{columns}
		\end{frame}			

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Structureless
		%\subsection{Structureless BBA}
		\begin{frame}{Structureless BBA}
	    
		\begin{columns}
			\column{0.5\textwidth}
			\setlength{\unitlength}{1cm}
			\hspace{1cm}
%
		Pipeline:
		\begin{itemize} 
			\item \footnotesize relative poses between all possible pairs \textcolor{red}{\textbf{simultaneously}}\\ (i.e. epipolar graph) 
			\item \footnotesize composition of triplets
			%\item \footnotesize robust tests and triplet-based BA
			\item \footnotesize initialisation of global poses and error averaging
		\end{itemize}
%  

		\column{0.65\textwidth}
		\setlength{\unitlength}{1cm}
		\includegraphics[width=7.5cm]{images/graph.pdf} 

		\end{columns}
		 
		\end{frame}	
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% SfM In MicMac		
		\begin{frame}{SfM and structureless BBA}
		
		\begin{itemize}
			\item in \texttt{MicMac}
		\end{itemize}
		
		\centering
		\includegraphics[width=3.5cm]{images/micmac_relative_pose.pdf}
		
		\end{frame}			
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% BBA
	\subsection{Bundle block adjustement}	
		\begin{frame}{Bundle block adjustement (BBA)}
		
		\begin{itemize}
		%\item applied in relative SfM or as stand-alone
		\item collinearity equations
		\item non-linear $\rightarrow$ \textcolor{red}{initial poses necessary}
		\item heterogenous observations/parameters possible:
			\begin{itemize}		
		 		\item Ground Control Points (GCP), 
		 		\item GNSS, 
		 		\item lever-arm,
		 		\item rigid bloc
		 	\end{itemize}		
		\end{itemize}		
		
		\end{frame}	

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Initial poses
%\section{Georeferencing, initialisation}
	\begin{frame}{BBA initial poses}
	
	BBA adopted in
	\begin{enumerate}
		\item SfM, always the same relative system initialisation not an issue
		\item absolute positioning
		\begin{itemize}
			\item input1: poses known in relative coordinates (SfM output)
			\item input2: GCP, GNSS are given in absolute coordinates
			\item \textcolor{red}{Transform from relative to absolute coordinates}
					\begin{itemize}
		\item rigid spatial similarity transformation (SST) (i.e. 7-param)
		\item "non-rigid" SST (i.e. 7-param + a polynomial)
		\end{itemize}
		\end{itemize}		
	\end{enumerate}		
	
 	
		 

		
		
	\end{frame}
	
	
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% BBA In MicMac		
		\begin{frame}{Bundle block adjustement (BBA)}

		\begin{itemize}
			\item in \texttt{MicMac}
		\end{itemize}
				
		\centering 
		\includegraphics[width=8cm]{images/MicMac_pose_estim_architecture.pdf}	
		
		\end{frame}	





			
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Ex slide        
%      \section{Ex Slide}  
%        \subsection{slide}
%            \begin{frame}{There Is No Largest Prime Number}
%                \framesubtitle{The proof uses \textit{reductio ad absurdum}.}
%                \begin{theorem}
%                    There is no largest prime number. \end{theorem}
%                \begin{enumerate}
%                    \item<1-| alert@1> Suppose $p$ were the largest prime number.
%                    \item<2-> Let $q$ be the product of the first $p$ numbers.
%                    \item<3-> Then $q+1$ is not divisible by any of them.
%                    \item<1-> But $q + 1$ is greater than $1$, thus divisible by some prime
%                    number not in the first $p$ numbers.
%                \end{enumerate}
%            \end{frame} 
        
\end{document}
